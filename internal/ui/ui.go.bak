package ui

import (
    "html/template"
    "net/http"
    "sync"
)

type UIStore struct{
    mu sync.RWMutex
    tasks map[string]string
}

func NewUIStore()*UIStore{
    return &UIStore{tasks: map[string]string{}}
}

func (u *UIStore) Add(id, data string){
    u.mu.Lock(); defer u.mu.Unlock()
    u.tasks[id]=data
}

func (u *UIStore) Handler(w http.ResponseWriter, r *http.Request){
    tpl := template.Must(template.ParseFiles("templates/index.html"))
    u.mu.RLock(); defer u.mu.RUnlock()
    tpl.Execute(w, u.tasks)
}
